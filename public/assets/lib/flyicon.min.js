async function flyHander(){if(window.innerWidth>=768)return!1;console.log("fly ready");let e=0;"undefined"!=typeof pSleepMinutes&&(e=pSleepMinutes),pUrls=localStorage.getItem("flyUrls"+pAffiliateId),pUrls&&(e=pDelayMinutes),setTimeout((async()=>{console.log("fly start");let e=36e5,n=window.innerWidth,t=0,i=!0;n>=768?(t=pWidthPCScreen,i=pIncludeClose):(t=pWidthMobileScreen,"undefined"!=typeof pIncludeCloseMobile&&(i=pIncludeCloseMobile));let l=[],o=[];await async function(){if(flyUrls=U("flyUrls"+pAffiliateId),flyBanner=U("flyBanner"+pAffiliateId),flyUrlsLoadTime=U("flyUrlsLoadTime"),!flyUrls||0==flyUrls.length||!flyUrlsLoadTime||Date.now()-flyUrlsLoadTime>=36e5){const e="MTcxNjY5NjAwMDBfVDdFUFBVSzJNNFVGTTZITU1UV1dQVEVVRUk3T0tQT1M",n=await fetch(`https://tkglobal.asia/api/common/get-urls-by-id?token=${e}&affId=${pAffiliateId}`),t=await n.json();"success"===t.status&&(flyUrls=t.response.urls,o=t.response.flyBanner,v("flyUrls"+pAffiliateId,JSON.stringify(flyUrls)),v("flyBanner"+pAffiliateId,JSON.stringify(o)),v("flyUrlsLoadTime",Date.now()),l=flyUrls)}else flyUrls=JSON.parse(flyUrls),flyBanner=JSON.parse(flyBanner),l=flyUrls,o=flyBanner}(),"undefined"!=typeof iconFollowLink&&1==iconFollowLink?(pBannerIndex=null!=p("pUrlIndex")?parseInt(p("pUrlIndex"))+1:0,pBannerIndex>=o.length&&(pBannerIndex=0)):pBannerIndex=Math.floor(Math.random()*o.length);let r=50;"undefined"!=typeof iconPosition&&(r=iconPosition);let a="";"undefined"!=typeof iconXAxis&&"left"==iconXAxis?a+=`100% - ${pWidthMobileScreen}px - 8px`:a+="8px";let c=`\n        <div id="pvoucher-live-container" style="position: fixed; top: ${r}%; right: calc(${a}); transform: translateY(-50%)">\n          <div class="position: relative;">\n            <div id="pvoucher-live-close" style="position: absolute; top: -20px; right: 0; background-color: #ffffff; border: 1px solid #bbbbbb; width: fit-content; display: inline; border-radius: 50%; padding: 3px 6px; font-size: 12px; font-weight: 600; cursor: pointer; line-height: initial;">\n              &#10006;\n            </div>\n            <div id="pvoucher-live-icon" style="width: ${t}px; cursor: pointer;">\n              <img src="${o[pBannerIndex]}" alt="" style="width: 100%;">\n            </div>\n          </div>\n        </div>\n      `,d=(new Date).getTime(),s=p("pEndLifeCircleTime");function f(e,n){localStorage.setItem(e,n)}function p(e){return localStorage.getItem(e)}function u(n,t){return n-t>pLoopTimeHours*e}function y(e){return e==l.length-1}function m(){document.querySelector("#pvoucher-live-container").style.display="none"}async function h(e,n){let t=p("pUrlIndex"),r=0;r="undefined"!=typeof iconFollowLink&&1==iconFollowLink?function(){let e=document.querySelector("#pvoucher-live-icon img").src;return o.indexOf(e)}()!=t?parseInt(t)+1:parseInt(t):parseInt(t)+1,r>=l.length&&(r=0),await y(r)&&(f("pEndLifeCircleTime",e),m()),f("pUrlIndex",r),i=!1,window.open(l[r],"_blank","noopener")}async function I(e=!1){let n=(new Date).getTime(),t=p("pEndLifeCircleTime");null!=p("pUrlIndex")?null!=t?await u(n,t)?h(n):e&&m():h(n):(await y(0)&&(f("pEndLifeCircleTime",n),m()),i=!1,f("pUrlIndex",0),window.open(l[0],"_blank","noopener"))}null!=s?await u(d,s)&&document.body.insertAdjacentHTML("beforeend",c):document.body.insertAdjacentHTML("beforeend",c),null!=document.querySelector("#pvoucher-live-icon")&&document.querySelector("#pvoucher-live-icon").addEventListener("click",(()=>{I()})),null!=document.querySelector("#pvoucher-live-close")&&document.querySelector("#pvoucher-live-close").addEventListener("click",(()=>{i?I(!0):m()}));const g=document.getElementById("pvoucher-live-icon");if(null!=g){!function e(){!function(e){let n=0;!function t(){const i=n/60,l=1-i,o=15*Math.sin(2*i*2*Math.PI)*l;g.style.transform=`rotate(${o}deg)`,n++,n<=60?requestAnimationFrame(t):(g.style.transform="rotate(0deg)",e&&e())}()}((()=>{setTimeout(e,1e3)}))}()}function v(e,n){localStorage.setItem(e,n)}function U(e){return localStorage.getItem(e)}}),60*e*1e3)}
